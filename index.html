<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Cove Mileage Automator</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class', // Enables toggle-based dark mode
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.2s; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
        /* Custom Scrollbar */
        .scroller::-webkit-scrollbar { width: 6px; }
        .scroller::-webkit-scrollbar-track { background: transparent; }
        .scroller::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 4px; }
        .dark .scroller::-webkit-scrollbar-thumb { background-color: #475569; }
    </style>
</head>
<body class="bg-slate-100 dark:bg-slate-900 text-slate-800 dark:text-slate-100 h-screen flex overflow-hidden transition-colors duration-300">

<div id="app" class="flex w-full h-full" :class="{ 'dark': isDarkMode }">

    <aside class="w-96 bg-white dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 flex flex-col z-20 shadow-xl overflow-y-auto transition-colors duration-300">
        <div class="p-6 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="bg-blue-700 text-white p-2 rounded-lg">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                </div>
                <div>
                    <h1 class="font-bold text-slate-800 dark:text-white text-lg leading-tight">Mileage<span class="text-blue-700 dark:text-blue-400">Pro</span></h1>
                    <p class="text-xs text-slate-400">Spring Cove SD</p>
                </div>
            </div>

            <button @click="toggleDarkMode" class="p-2 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors">
                <svg v-if="!isDarkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
                <svg v-else class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
            </button>
        </div>

        <div class="p-6 space-y-5 border-b border-slate-100 dark:border-slate-700">
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider">Employee Details</h3>

            <div>
                <label class="block text-sm font-medium text-slate-600 dark:text-slate-300 mb-1">Full Name</label>
                <input v-model="user.name" type="text" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg px-3 py-2 text-sm text-slate-800 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none transition-all placeholder-slate-400 dark:placeholder-slate-500" placeholder="e.g. Jane Doe">
            </div>

            <div>
                <label class="block text-sm font-medium text-slate-600 dark:text-slate-300 mb-1">Home Building</label>
                <select v-model="user.building" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg px-3 py-2 text-sm text-slate-800 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none">
                    <option v-for="loc in departureLocations" :value="loc">{{ loc }}</option>
                </select>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div>
                    <label class="block text-sm font-medium text-slate-600 dark:text-slate-300 mb-1">Month</label>
                    <select v-model="config.month" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg px-3 py-2 text-sm text-slate-800 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none">
                        <option v-for="(m, index) in months" :value="index">{{ m }}</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-600 dark:text-slate-300 mb-1">Year</label>
                    <input v-model.number="config.year" type="number" class="w-full bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg px-3 py-2 text-sm text-slate-800 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
            </div>
        </div>

        <div class="p-6 space-y-5 flex-1 bg-blue-50/30 dark:bg-blue-900/10">
            <div class="flex items-center justify-between">
                <h3 class="text-xs font-bold text-blue-800 dark:text-blue-400 uppercase tracking-wider">Active Route Selection</h3>
                <span class="text-[10px] bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 px-2 py-0.5 rounded-full font-medium">Ready to Assign</span>
            </div>

            <div class="space-y-4">
                <div class="relative group">
                    <label class="block text-sm font-medium text-slate-600 dark:text-slate-300 mb-1">Departure</label>
                    <select v-model="route.from" class="w-full bg-white dark:bg-slate-700 border border-blue-200 dark:border-slate-600 rounded-lg px-3 py-2 text-sm text-slate-800 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none shadow-sm">
                        <option v-for="loc in departureLocations" :value="loc">{{ loc }}</option>
                    </select>
                </div>

                <div class="relative group">
                    <label class="block text-sm font-medium text-slate-600 dark:text-slate-300 mb-1">Destination</label>
                    <select v-model="route.to" class="w-full bg-white dark:bg-slate-700 border border-blue-200 dark:border-slate-600 rounded-lg px-3 py-2 text-sm text-slate-800 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none shadow-sm">
                        <option v-for="loc in orderedDestinations" :value="loc">{{ loc }}</option>
                    </select>
                </div>
            </div>

            <div class="bg-white dark:bg-slate-800 border border-blue-100 dark:border-slate-600 rounded-xl p-4 flex items-center justify-between mt-4 shadow-sm">
                <div>
                    <span class="block text-xs font-bold text-blue-800 dark:text-blue-400 uppercase">Trip Distance</span>
                </div>
                <div class="text-right">
                    <span class="text-2xl font-bold text-blue-700 dark:text-blue-400">{{ currentDistance }}</span>
                    <span class="text-sm font-medium text-blue-500 dark:text-blue-300">mi</span>
                </div>
            </div>

            <div class="mt-4">
                <label class="block text-sm font-medium text-slate-600 dark:text-slate-300 mb-1">Reason for Travel</label>
                <textarea v-model="user.reason" rows="2" class="w-full bg-white dark:bg-slate-700 border border-blue-200 dark:border-slate-600 rounded-lg px-3 py-2 text-sm text-slate-800 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none resize-none shadow-sm placeholder-slate-400 dark:placeholder-slate-500" placeholder="e.g. Itinerant Services"></textarea>
            </div>

            <div class="mt-2 pt-4 border-t border-blue-100 dark:border-slate-700">
                <label class="block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1">IRS Rate ($)</label>
                <input v-model.number="config.rate" type="number" step="0.001" class="w-24 bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg px-2 py-1 text-xs text-slate-800 dark:text-white outline-none">
            </div>
        </div>

        <div class="p-6 border-t border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 z-10 transition-colors duration-300">
            <button @click="generatePDF" class="w-full bg-blue-700 hover:bg-blue-800 dark:bg-blue-600 dark:hover:bg-blue-500 text-white font-semibold py-3 px-4 rounded-lg shadow-lg shadow-blue-200 dark:shadow-none transition-all flex items-center justify-center gap-2 group">
                <span>Generate PDF</span>
                <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
            </button>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-full overflow-hidden bg-slate-100 dark:bg-slate-900 p-4 sm:p-8 transition-colors duration-300">

        <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 flex-1 flex flex-col overflow-hidden max-w-6xl mx-auto w-full transition-colors duration-300">
            <div class="px-8 py-6 border-b border-slate-100 dark:border-slate-700 flex justify-between items-end bg-white dark:bg-slate-800 transition-colors duration-300">
                <div>
                    <h2 class="text-2xl font-bold text-slate-800 dark:text-white">{{ months[config.month] }} {{ config.year }}</h2>
                    <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">Click dates below to add this specific trip ({{ currentDistance }} mi).</p>
                </div>
                <div class="text-right hidden sm:block">
                    <div class="text-3xl font-bold text-slate-900 dark:text-white">{{ Object.keys(trips).length }}</div>
                    <div class="text-xs font-medium text-slate-400 uppercase tracking-wide">Days Logged</div>
                </div>
            </div>

            <div class="p-8 flex-1 overflow-y-auto scroller bg-slate-50/30 dark:bg-slate-900/30">
                <div class="grid grid-cols-7 mb-4">
                    <div v-for="day in ['SUN','MON','TUE','WED','THU','FRI','SAT']" class="text-center text-xs font-bold text-slate-400 tracking-widest">
                        {{ day }}
                    </div>
                </div>

                <div class="grid grid-cols-7 gap-3 sm:gap-4">
                    <div v-for="blank in startDayOffset" :key="'blank-' + blank" class="aspect-[1/1] sm:aspect-[4/3]"></div>

                    <button
                        v-for="day in daysInMonth"
                        :key="day"
                        @click="toggleDate(day)"
                        class="relative rounded-xl border-2 transition-all duration-200 flex flex-col items-center justify-between p-2 group overflow-hidden"
                        :class="[
                            trips[day]
                                ? 'border-blue-500 ring-1 ring-blue-500 bg-blue-50 dark:bg-blue-900/30'
                                : 'border-transparent dark:border-slate-700 bg-white dark:bg-slate-700/50 hover:border-blue-300 dark:hover:border-slate-500 text-slate-400 dark:text-slate-500',
                            isHoliday(day) && !trips[day] ? 'bg-red-50/50 dark:bg-red-900/10' : ''
                        ]"
                    >
                        <div class="flex justify-between w-full items-start">
                            <span class="text-lg font-semibold" :class="trips[day] ? 'text-blue-700 dark:text-blue-300' : ''">{{ day }}</span>
                            <span v-if="isHoliday(day)" class="text-[9px] font-bold text-red-500 dark:text-red-300 bg-red-100 dark:bg-red-900/40 px-1.5 py-0.5 rounded leading-tight text-right max-w-[70%] truncate">
                                {{ isHoliday(day) }}
                            </span>
                        </div>

                        <div v-if="trips[day]" class="w-full mt-1">
                            <div class="text-[10px] font-bold text-blue-600 dark:text-blue-200 bg-white/80 dark:bg-blue-900/50 rounded px-1.5 py-0.5 truncate border border-blue-100 dark:border-blue-800 shadow-sm mb-0.5">
                                {{ trips[day].distance }} mi
                            </div>
                             <div class="text-[9px] text-blue-500 dark:text-blue-300 truncate leading-tight px-0.5">
                                to {{ trips[day].to }}
                            </div>
                        </div>

                        <div v-else class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 pointer-events-none">
                            <span class="text-xs font-bold text-blue-300 dark:text-slate-400">+{{ currentDistance }}</span>
                        </div>
                    </button>
                </div>
            </div>

            <div class="bg-white dark:bg-slate-800 px-8 py-4 border-t border-slate-200 dark:border-slate-700 flex justify-between items-center shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.02)] z-10 transition-colors duration-300">
                <div class="text-xs text-slate-400 hidden sm:block">
                    Holidays in red. Calculated at ${{ config.rate }}/mile.
                </div>
                <div class="flex items-baseline gap-2 w-full sm:w-auto justify-end">
                    <span class="text-sm text-slate-500 dark:text-slate-400">Total:</span>
                    <span class="text-xl font-bold text-slate-800 dark:text-white">{{ totalMiles.toFixed(1) }}</span>
                    <span class="text-sm text-slate-500 dark:text-slate-400">miles</span>
                    <span class="mx-2 text-slate-300 dark:text-slate-600">|</span>
                    <span class="text-xl font-bold text-green-600 dark:text-green-400">${{ (totalMiles * config.rate).toFixed(2) }}</span>
                </div>
            </div>
        </div>
    </main>

</div>

<script>
    const { createApp } = Vue;
    const { PDFDocument } = PDFLib;

    createApp({
        data() {
            return {
                isDarkMode: localStorage.getItem('mileage_theme') === 'dark',
                months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                user: {
                    name: localStorage.getItem('mileage_name') || '',
                    building: localStorage.getItem('mileage_building') || 'Admin Office',
                    reason: localStorage.getItem('mileage_reason') || 'Itinerant Services'
                },
                config: {
                    year: 2026,
                    month: 0,
                    rate: 0.725
                },
                route: {
                    from: 'Admin Office',
                    to: 'Central High School'
                },
                trips: {},
                // Destination List
                orderedDestinations: [
                    "Admin Office", "Central High School", "Martinsburg Elem.", "Middle School", "Spring Cove Elem.",
                    "Athletic Field", "Bean Hill", "Giant Eagle", "GACTC",
                    "IU 08 (Duncansville)", "IU 08 (Ebensburg)", "IU 08 (Altoona)",
                    "Altoona Grand Hotel", "Mtbg. Post Office", "R.S. Post Office",
                    "FNB - Roaring Spring", "Spring Plaza", "Harrisburg",
                    "Walmart (East Freedom)", "Walmart / Sam's (Altoona)"
                ],
                // Master Matrix
                distances: {
                    "Admin Office": {
                        "Admin Office": 0, "Central High School": 4.5, "Martinsburg Elem.": 4.2, "Middle School": 0.2, "Spring Cove Elem.": 0.1,
                        "Athletic Field": 1.8, "Bean Hill": 4.6, "Giant Eagle": 1.3, "GACTC": 15.9, "IU 08 (Duncansville)": 13.8, "IU 08 (Ebensburg)": 28.3, "IU 08 (Altoona)": 7.9,
                        "Altoona Grand Hotel": 11.8, "Mtbg. Post Office": 3.7, "R.S. Post Office": 0.6, "FNB - Roaring Spring": 0.5, "Spring Plaza": 3.7, "Harrisburg": 109,
                        "Walmart (East Freedom)": 3.7, "Walmart / Sam's (Altoona)": 12
                    },
                    "Central High School": {
                        "Admin Office": 4.5, "Central High School": 0, "Martinsburg Elem.": 1.4, "Middle School": 4.6, "Spring Cove Elem.": 4.5,
                        "Athletic Field": 5.3, "Bean Hill": 4.7, "Giant Eagle": 5.6, "GACTC": 20.4, "IU 08 (Duncansville)": 18.3, "IU 08 (Ebensburg)": 32.8, "IU 08 (Altoona)": 12.4,
                        "Altoona Grand Hotel": 16.3, "Mtbg. Post Office": 1.1, "R.S. Post Office": 5.1, "FNB - Roaring Spring": 4.8, "Spring Plaza": 0.5, "Harrisburg": 105,
                        "Walmart (East Freedom)": 8.3, "Walmart / Sam's (Altoona)": 16.5
                    },
                    "Martinsburg Elem.": {
                        "Admin Office": 4.2, "Central High School": 1.4, "Martinsburg Elem.": 0, "Middle School": 4.3, "Spring Cove Elem.": 4.2,
                        "Athletic Field": 5.0, "Bean Hill": 5.6, "Giant Eagle": 5.3, "GACTC": 20.1, "IU 08 (Duncansville)": 18.0, "IU 08 (Ebensburg)": 32.5, "IU 08 (Altoona)": 12.1,
                        "Altoona Grand Hotel": 16.0, "Mtbg. Post Office": 0.4, "R.S. Post Office": 4.8, "FNB - Roaring Spring": 4.5, "Spring Plaza": 0.2, "Harrisburg": 105,
                        "Walmart (East Freedom)": 7.9, "Walmart / Sam's (Altoona)": 16.2
                    },
                    "Middle School": {
                        "Admin Office": 0.2, "Central High School": 4.6, "Martinsburg Elem.": 4.3, "Middle School": 0, "Spring Cove Elem.": 0.1,
                        "Athletic Field": 2.0, "Bean Hill": 1.5, "Giant Eagle": 1.5, "GACTC": 16.1, "IU 08 (Duncansville)": 14.0, "IU 08 (Ebensburg)": 28.5, "IU 08 (Altoona)": 8.0,
                        "Altoona Grand Hotel": 12.0, "Mtbg. Post Office": 3.9, "R.S. Post Office": 0.8, "FNB - Roaring Spring": 0.7, "Spring Plaza": 3.9, "Harrisburg": 109,
                        "Walmart (East Freedom)": 3.9, "Walmart / Sam's (Altoona)": 12.2
                    },
                    "Spring Cove Elem.": {
                        "Admin Office": 0.1, "Central High School": 4.5, "Martinsburg Elem.": 4.2, "Middle School": 0.1, "Spring Cove Elem.": 0,
                        "Athletic Field": 1.9, "Bean Hill": 1.4, "Giant Eagle": 1.4, "GACTC": 16.0, "IU 08 (Duncansville)": 13.9, "IU 08 (Ebensburg)": 28.4, "IU 08 (Altoona)": 8.0,
                        "Altoona Grand Hotel": 11.9, "Mtbg. Post Office": 3.8, "R.S. Post Office": 0.7, "FNB - Roaring Spring": 0.6, "Spring Plaza": 3.8, "Harrisburg": 110,
                        "Walmart (East Freedom)": 3.8, "Walmart / Sam's (Altoona)": 12.1
                    }
                }
            }
        },
        computed: {
            departureLocations() { return Object.keys(this.distances); },
            currentDistance() {
                const fromRow = this.distances[this.route.from];
                if (fromRow && fromRow[this.route.to] !== undefined) return fromRow[this.route.to];
                return 0;
            },
            totalMiles() {
                return Object.values(this.trips).reduce((acc, trip) => acc + trip.distance, 0);
            },
            daysInMonth() { return new Date(this.config.year, this.config.month + 1, 0).getDate(); },
            startDayOffset() { return new Date(this.config.year, this.config.month, 1).getDay(); },

            currentMonthHolidays() {
                const year = this.config.year;
                const month = this.config.month;
                const holidays = {};

                const getNthWeekday = (n, weekday, m, y) => {
                    let date = new Date(y, m, 1);
                    let count = 0;
                    while (date.getMonth() === m) {
                        if (date.getDay() === weekday) {
                            count++;
                            if (count === n) return date.getDate();
                        }
                        date.setDate(date.getDate() + 1);
                    }
                    return null;
                };

                const getLastWeekday = (weekday, m, y) => {
                    let date = new Date(y, m + 1, 0);
                    while (date.getDay() !== weekday) {
                        date.setDate(date.getDate() - 1);
                    }
                    return date.getDate();
                };

                if (month === 0) holidays[1] = "New Year's";
                if (month === 5) holidays[19] = "Juneteenth";
                if (month === 6) holidays[4] = "Independence Day";
                if (month === 10) holidays[11] = "Veterans Day";
                if (month === 11) holidays[25] = "Christmas";

                if (month === 0) holidays[getNthWeekday(3, 1, 0, year)] = "MLK Day";
                if (month === 1) holidays[getNthWeekday(3, 1, 1, year)] = "Presidents' Day";
                if (month === 4) holidays[getLastWeekday(1, 4, year)] = "Memorial Day";
                if (month === 8) holidays[getNthWeekday(1, 1, 8, year)] = "Labor Day";
                if (month === 9) holidays[getNthWeekday(2, 1, 9, year)] = "Columbus Day";
                if (month === 10) holidays[getNthWeekday(4, 4, 10, year)] = "Thanksgiving";

                return holidays;
            }
        },
        watch: {
            'user.name'(val) { localStorage.setItem('mileage_name', val); },
            'user.building'(val) { localStorage.setItem('mileage_building', val); },
            'user.reason'(val) { localStorage.setItem('mileage_reason', val); },
            'config.month'() { this.trips = {}; },
            'isDarkMode'(val) { localStorage.setItem('mileage_theme', val ? 'dark' : 'light'); }
        },
        methods: {
            toggleDarkMode() {
                this.isDarkMode = !this.isDarkMode;
            },
            isHoliday(day) {
                return this.currentMonthHolidays[day] || false;
            },
            toggleDate(day) {
                if (this.trips[day] &&
                    this.trips[day].from === this.route.from &&
                    this.trips[day].to === this.route.to) {
                    delete this.trips[day];
                } else {
                    this.trips[day] = {
                        from: this.route.from,
                        to: this.route.to,
                        distance: this.currentDistance,
                        reason: this.user.reason
                    };
                }
            },
            async generatePDF() {
                try {
                    // UPDATED: Now looks for the simpler filename
                    const existingPdfBytes = await fetch('mileageform.pdf').then(res => res.arrayBuffer());
                    const pdfDoc = await PDFDocument.load(existingPdfBytes);
                    const form = pdfDoc.getForm();

                    // 1. Header Fields
                    try { form.getTextField('NAME').setText(this.user.name); } catch(e){}
                    try { form.getTextField('BUILDING').setText(this.user.building); } catch(e){}
                    try { form.getTextField('MONTH').setText(this.months[this.config.month]); } catch(e){}
                    try { form.getTextField('YEAR').setText(this.config.year.toString()); } catch(e){}

                    // 2. Rows
                    const sortedDays = Object.keys(this.trips).map(Number).sort((a, b) => a - b);

                    sortedDays.slice(0, 12).forEach((day, index) => {
                        const row = index + 1;
                        const trip = this.trips[day];
                        const dateStr = `${this.config.month + 1}/${day}/${this.config.year}`;

                        try {
                            form.getTextField(`DATE Row${row}`).setText(dateStr);
                            form.getTextField(`FROM Row${row}`).setText(trip.from);
                            form.getTextField(`TO Row${row}`).setText(trip.to);
                            form.getTextField(`MILES In Tenths Row${row}`).setText(trip.distance.toString());
                            form.getTextField(`PURPOSE  GIVE DETAILS Row${row}`).setText(trip.reason);
                        } catch (e) { console.warn("Row fill error", e); }
                    });

                    // 3. Totals
                    try {
                        const totalDollars = (this.totalMiles * this.config.rate).toFixed(2);
                        form.getTextField('Total Expenses').setText(`$${totalDollars}`);
                    } catch(e) {}

                    // 4. Download
                    const pdfBytes = await pdfDoc.save();
                    const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `Mileage_${this.months[this.config.month]}.pdf`;
                    link.click();
                } catch (e) {
                    alert("Error! Make sure your PDF is named 'mileageform.pdf' and is in the same folder.");
                    console.error(e);
                }
            }
        }
    }).mount('#app');
</script>
</body>
</html>
